{
    "version": "https://jsonfeed.org/version/1",
    "title": "一方天地",
    "subtitle": "",
    "icon": "http://yoursite.com/images/favicon.ico",
    "description": "",
    "home_page_url": "http://yoursite.com",
    "items": [
        {
            "id": "http://yoursite.com/2021/12/01/%E7%BD%AE%E9%A1%B6%E6%96%87%E7%AB%A0/",
            "url": "http://yoursite.com/2021/12/01/%E7%BD%AE%E9%A1%B6%E6%96%87%E7%AB%A0/",
            "title": "置顶文章",
            "date_published": "2021-12-01T10:52:37.379Z",
            "content_html": "<h1 id=\"这是我的blog\"><a class=\"anchor\" href=\"#这是我的blog\">#</a> 这是我的 BLOG！</h1>\n<p>这里是影风。</p>\n<p>瞎搞了许多时间，总算让自己的博客像了点样。作为一名深度二次元，我在 hexo 的主题库里一眼看中了 shoka 这个神仙主题，并搭建了这个博客。接下来的时间，我将用这个博客记录自己的学习历程，同时装一些学习资料，也能起到学习之用。未来基于当前主题，我将会继续探索和自定义，将主题变成属于我自己的主题。</p>\n<p>这里将会是我的一方天地。</p>\n",
            "tags": []
        },
        {
            "id": "http://yoursite.com/2021/11/28/hello-world/",
            "url": "http://yoursite.com/2021/11/28/hello-world/",
            "title": "Hello World",
            "date_published": "2021-11-28T03:12:17.328Z",
            "content_html": "<p>Welcome to <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvLw==\">Hexo</span>! This is your very first post. Check <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mv\">documentation</span> for more info. If you get any problems when using Hexo, you can find the answer in <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3MvdHJvdWJsZXNob290aW5nLmh0bWw=\">troubleshooting</span> or you can ask me on <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2hleG9qcy9oZXhvL2lzc3Vlcw==\">GitHub</span>.</p>\n<h2 id=\"quick-start\"><a class=\"anchor\" href=\"#quick-start\">#</a> Quick Start</h2>\n<h3 id=\"create-a-new-post\"><a class=\"anchor\" href=\"#create-a-new-post\">#</a> Create a new post</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo new <span class=\"token string\">\"My New Post\"</span></pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvd3JpdGluZy5odG1s\">Writing</span></p>\n<h3 id=\"run-server\"><a class=\"anchor\" href=\"#run-server\">#</a> Run server</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo server</pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvc2VydmVyLmh0bWw=\">Server</span></p>\n<h3 id=\"generate-static-files\"><a class=\"anchor\" href=\"#generate-static-files\">#</a> Generate static files</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo generate</pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3MvZ2VuZXJhdGluZy5odG1s\">Generating</span></p>\n<h3 id=\"deploy-to-remote-sites\"><a class=\"anchor\" href=\"#deploy-to-remote-sites\">#</a> Deploy to remote sites</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo deploy</pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvb25lLWNvbW1hbmQtZGVwbG95bWVudC5odG1s\">Deployment</span></p>\n",
            "tags": []
        },
        {
            "id": "http://yoursite.com/2021/10/25/%E4%BC%98%E6%83%A0%E5%88%B8%E6%8E%A5%E5%8F%97%E4%B8%8E%E5%90%A6%E9%A2%84%E6%B5%8B/",
            "url": "http://yoursite.com/2021/10/25/%E4%BC%98%E6%83%A0%E5%88%B8%E6%8E%A5%E5%8F%97%E4%B8%8E%E5%90%A6%E9%A2%84%E6%B5%8B/",
            "title": "",
            "date_published": "2021-10-25T12:34:42.246Z",
            "content_html": "<hr />\n<h2 id=\"title机器学习最初战\"><a class=\"anchor\" href=\"#title机器学习最初战\">#</a> title: 机器学习最初战</h2>\n<h1 id=\"优惠券接受与否预测\"><a class=\"anchor\" href=\"#优惠券接受与否预测\">#</a> 优惠券接受与否预测</h1>\n<h1 id=\"1数据处理\"><a class=\"anchor\" href=\"#1数据处理\">#</a> 1. 数据处理</h1>\n<h2 id=\"1数据分析\"><a class=\"anchor\" href=\"#1数据分析\">#</a> （1）数据分析</h2>\n<p>在获得数据集之后，我首先对每类特征在基于自己的理解上进行了分析，以下是我分析的结果：</p>\n<p>1.destination：目前所处位置，可能与顾客目前是否介意被打扰有关</p>\n<p>2.passanger：车上所载乘客，目前尚不清楚有何关系</p>\n<p>3.weather、temperature：个人感觉与是否接受优惠券关系较小，先不考虑</p>\n<p>4.time：可能与是否接近饭点，是否想要进餐有关</p>\n<p>5.coupon：优惠券种类，推荐优惠券类型可能与之后顾客去不同地点的次数密切相关，需要关注</p>\n<p>6.expiration：优惠券到期时间，可能与顾客是否想接受有关，到期时间越长可能越容易被接受</p>\n<p>7.gender、age、maritalStatus、has_Children、education：我暂时无法确定这些特征与结果的相关性，先不考虑</p>\n<p>8.occupation：这是所有特征中种类最多最庞杂的，但个人感觉职业与收入相挂钩，或者是社会地位。</p>\n<p>9.income：与钱相关，可以判断哪些收入的人群更易接受优惠券</p>\n<p>10.Bar、CoffeeHouse、CarryAway、RestaurantLessThan20、Restaurant20To50：该五种特征中，种类都相同，可以看作一类特征，可认为平常去某个地点越多，越容易接受该地点的优惠券，应该与 coupon 特征一起考虑。</p>\n<p>11.toCoupon_GEQ5min、toCoupon_GEQ15min、toCoupon_GEQ25min：前往饭店时间可能也与是否接受挂钩</p>\n<p>12.direction_same、direction_opp：如果饭店在相同方向可能更易接受优惠券</p>\n<h2 id=\"2数据预处理\"><a class=\"anchor\" href=\"#2数据预处理\">#</a> （2）数据预处理</h2>\n<p>在分析完数据之后，便可以在此基础上对数据进行处理。</p>\n<p>首先利用 isnull () 函数查看缺失值，Bar、CoffeeHouse、CarryAway、RestaurantLessThan20、Restaurant20To50 这种类相同的特征分别含有少量缺失值，我选择分别利用它们中种类最多的特征进行填充，并根据次数将特征换为 0、1、2、3、4，便于进一步计算。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'Bar'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'Bar'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>fillna<span class=\"token punctuation\">(</span><span class=\"token string\">'never'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'CoffeeHouse'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'CoffeeHouse'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>fillna<span class=\"token punctuation\">(</span><span class=\"token string\">'less1'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'CarryAway'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'CarryAway'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>fillna<span class=\"token punctuation\">(</span><span class=\"token string\">'1~3'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'RestaurantLessThan20'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'RestaurantLessThan20'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>fillna<span class=\"token punctuation\">(</span><span class=\"token string\">'1~3'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'Restaurant20To50'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'Restaurant20To50'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>fillna<span class=\"token punctuation\">(</span><span class=\"token string\">'less1'</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\"># 根据每种特征的数量最多的类型进行数据填充</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">cate</span><span class=\"token punctuation\">(</span>cate1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span>cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'never'</span><span class=\"token punctuation\">,</span> cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span>cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'less1'</span><span class=\"token punctuation\">,</span> cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span>cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'1~3'</span><span class=\"token punctuation\">,</span> cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span>cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'4~8'</span><span class=\"token punctuation\">,</span> cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span>cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'gt8'</span><span class=\"token punctuation\">,</span> cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">4</span>            <span class=\"token comment\"># 数值化处理</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"14\"></td><td><pre>cate<span class=\"token punctuation\">(</span><span class=\"token string\">'Bar'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>cate<span class=\"token punctuation\">(</span><span class=\"token string\">'CoffeeHouse'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>cate<span class=\"token punctuation\">(</span><span class=\"token string\">'CarryAway'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>cate<span class=\"token punctuation\">(</span><span class=\"token string\">'RestaurantLessThan20'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>cate<span class=\"token punctuation\">(</span><span class=\"token string\">'Restaurant20To50'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>接下来是 destination，对数据可视化并进行分析后可看出，在家中和在工作中和在一些无关紧要的地方对是否接受优惠券有明显的影响，我选择直接将三个变量赋值 1、2、3，之后在进行进一步处理。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'destination'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'No Urgent Place'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'destination'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'destination'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Home'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'destination'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'destination'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Work'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'destination'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span>     <span class=\"token comment\"># 处理 destination 特征</span></pre></td></tr></table></figure><p>time 特征查看后与我预测中一致，首先我还是按照时间早晚来将数据转换为数值类型。expiration 我选择将两类数据直接转换为 1、0。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'expiration'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'1d'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'expiration'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'expiration'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'2h'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'expiration'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span>  <span class=\"token comment\"># expiration 特征处理</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'7AM'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'10AM'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'2PM'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'6PM'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'10PM'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">4</span>  <span class=\"token comment\"># time 特征处理</span></pre></td></tr></table></figure><p>接下来一些特征我无法明显判断与结果的关系，选择采用独热编码的方法进行处理，这类特征包括：passanger、weather、temperature、maritalStatus、gender。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>le <span class=\"token operator\">=</span> LabelEncoder<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ohc <span class=\"token operator\">=</span> OneHotEncoder<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">cate2</span><span class=\"token punctuation\">(</span>cate3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">global</span> couponCsv</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> cate3<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> le<span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span>cate3<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    alldf <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>get_dummies<span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span>cate3<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> prefix<span class=\"token operator\">=</span>cate3<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    couponCsv <span class=\"token operator\">=</span> couponCsv<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>cate3<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    couponCsv <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>concat<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">,</span> alldf<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>         </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token comment\"># 定义一个独热编码处理函数，先数值化处理再利用 get_dummies 进行独热编码，并将得到的数据添加进数据集中</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>cate2<span class=\"token punctuation\">(</span><span class=\"token string\">'gender'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>cate2<span class=\"token punctuation\">(</span><span class=\"token string\">'passanger'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>cate2<span class=\"token punctuation\">(</span><span class=\"token string\">'weather'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>cate2<span class=\"token punctuation\">(</span><span class=\"token string\">'maritalStatus'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>cate2<span class=\"token punctuation\">(</span><span class=\"token string\">'temperature'</span><span class=\"token punctuation\">)</span>                                          <span class=\"token comment\"># 调用函数转化</span></pre></td></tr></table></figure><p>处理 income 特征时我同样按照收入高低直接将特征转换为数值，同时重新进行可视化处理，并未发现在收入上接受优惠券与否之间明显的不同。但当我选择将这些特征按收入高低分成三类时，可以发现差距变得明显起来。于是我决定暂时先将收入特征按此方式处理。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Less than $12500'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'$12500 - $24999'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'$25000 - $37499'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'$37500 - $49999'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'$50000 - $62499'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'$62500 - $74999'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'$75000 - $87499'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'$87500 - $99999'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'$100000 or More'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span>       <span class=\"token comment\"># income 特征处理</span></pre></td></tr></table></figure><p>处理 occupation 时我根据自己的主观判断来进行划分，以每类职业相近的化为一类，统一以 0、1、2 三类表示。代码手打，比较庞杂，就暂时不列出来了。</p>\n<p>direction_same、direction_opp 这两个特征完全可以合为同一个特征，其实也就只需要利用其中一个就好了，我选择去除其中一列。</p>\n<p>toCoupon_GEQ5min、toCoupon_GEQ15min、toCoupon_GEQ25min 三类特征也与是否接受有关，但三者有相关性，这里我决定创建一个新特征，命名为 toCoupon，时间小于 5 分钟为一类，时间介于 5 分钟到 15 分钟为一类，时间介于 15 分钟到 25 分钟为一类，大于 25 分钟为一类。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>nan</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon_GEQ5min'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon_GEQ5min'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon_GEQ15min'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon_GEQ15min'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon_GEQ25min'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon_GEQ25min'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">3</span></pre></td></tr></table></figure><p>Bar、CoffeeHouse、CarryAway、RestaurantLessThan20、Restaurant20To50 这五类特征还能进行进一步处理，我认为这里可以结合推荐的优惠券种类来新增一个特征，我称其为优惠券与顾客习惯的契合度，在这里命名为 accept，处理方法主要专注于 coupon 一个特征，对应发放优惠券种类的五种特征进行新特征的创建。之前已经对 Bar、CoffeeHouse、CarryAway、RestaurantLessThan20、Restaurant20To50 五类特征进行了处理，这里直接利用数值。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">cate4</span><span class=\"token punctuation\">(</span>cate6<span class=\"token punctuation\">,</span> cate5<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'coupon'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> cate6<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span>cate5<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'accept'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'coupon'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> cate6<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span>cate5<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'accept'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'coupon'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> cate6<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span>cate5<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'accept'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'coupon'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> cate6<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span>cate5<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'accept'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'coupon'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> cate6<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span>cate5<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'accept'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">4</span>   <span class=\"token comment\"># 创建处理函数</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>cate4<span class=\"token punctuation\">(</span><span class=\"token string\">'Restaurant(&lt;20)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'RestaurantLessThan20'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>cate4<span class=\"token punctuation\">(</span><span class=\"token string\">'Coffee House'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'CoffeeHouse'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>cate4<span class=\"token punctuation\">(</span><span class=\"token string\">'Carry out &amp; Take away'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'CarryAway'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>cate4<span class=\"token punctuation\">(</span><span class=\"token string\">'Bar'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Bar'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>cate4<span class=\"token punctuation\">(</span><span class=\"token string\">'Restaurant(20-50)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Restaurant20To50'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 对特征进行处理</span></pre></td></tr></table></figure><p>（在这里选择特征进行处理时，我考虑过最后套用模型时是否加入 coupon 这类特征，因为个人感觉与 accept 特征重复，但最后套用算法后发现加上这一特征的正确率更高一点）</p>\n<p>之后还进行了数据的标准化处理，这里的处理是针对划分后的训练集和测试集的，我分别尝试了两种方法，最终结果差距不大。这两种分别是 MinMaxScaler 和 StandardScaler 函数。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>source_X <span class=\"token operator\">=</span> couponCsv<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token punctuation\">[</span><span class=\"token string\">\"direction_same\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'toCoupon_GEQ5min'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'toCoupon_GEQ15min'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'toCoupon_GEQ25min'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Y\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>source_y <span class=\"token operator\">=</span> couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'Y'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>train_X<span class=\"token punctuation\">,</span> test_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">,</span> test_y <span class=\"token operator\">=</span> train_test_split<span class=\"token punctuation\">(</span>source_X<span class=\"token punctuation\">,</span> source_y<span class=\"token punctuation\">,</span> train_size<span class=\"token operator\">=</span><span class=\"token number\">0.75</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 划分测试集和训练集</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>sc <span class=\"token operator\">=</span> StandardScaler<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\"># 可换为 MinMaxScaler</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>train_X <span class=\"token operator\">=</span> sc<span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>test_X <span class=\"token operator\">=</span> sc<span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>test_X<span class=\"token punctuation\">)</span>     <span class=\"token comment\"># 数据标准化化处理</span></pre></td></tr></table></figure><h1 id=\"2特征选择\"><a class=\"anchor\" href=\"#2特征选择\">#</a> 2. 特征选择</h1>\n<p>这一步我打算计算各个特征与标签的相关性，但是在进行计算后发现本样本特征数量较少，在利用上大多数特征后才能得到最佳结果，在我实际当中测试也是一样，一部分特征去掉与否对模型性能无影响，一部分去掉后模型性能降低。于是这里我决定从简处理，直接全部用上。</p>\n<h1 id=\"3调用算法\"><a class=\"anchor\" href=\"#3调用算法\">#</a> 3. 调用算法</h1>\n<p>这一步其实比较简单了，我选择了七种算法，直接来源于 sklearn 库中打包好的算法，十分方便，先从这几种算法中找出效果最好的一种，再对其进行调参以得到最佳的模型效果。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 逻辑回归</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>model <span class=\"token operator\">=</span> LogisticRegression<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"逻辑回归:\"</span><span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">(</span>test_X<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 随机森林</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>model <span class=\"token operator\">=</span> RandomForestClassifier<span class=\"token punctuation\">(</span>n_estimators<span class=\"token operator\">=</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"随机森林:\"</span><span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">(</span>test_X<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># 支持向量机</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>model <span class=\"token operator\">=</span> SVC<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"支持向量机:\"</span><span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">(</span>test_X<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># 梯度提升决策树</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>model <span class=\"token operator\">=</span> GradientBoostingClassifier<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"梯度提升决策分类:\"</span><span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">(</span>test_X<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\"># KNN 算法</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>model <span class=\"token operator\">=</span> KNeighborsClassifier<span class=\"token punctuation\">(</span>n_neighbors<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"KNN算法:\"</span><span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">(</span>test_X<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\"># 朴素贝叶斯分类</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>model <span class=\"token operator\">=</span> GaussianNB<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"朴素贝叶斯分类:\"</span><span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">(</span>test_X<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token comment\"># 决策树</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>model <span class=\"token operator\">=</span> DecisionTreeClassifier<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"决策树:\"</span><span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">(</span>test_X<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token comment\"># AdaBoostClassifier 算法</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>model <span class=\"token operator\">=</span> AdaBoostClassifier<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"AdaBoost算法:\"</span><span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">(</span>test_X<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>最终输出的结果如下：</p>\n<pre><code>逻辑回归: 0.7172884918549658\n随机森林: 0.7761429322122964\n支持向量机: 0.7383079348397268\n梯度提升决策分类: 0.7325275880189175\nKNN算法: 0.6920651602732527\n朴素贝叶斯分类: 0.6773515501839201\n决策树: 0.6936416184971098\nAdaBoost算法: 0.6962690488702049\n</code></pre>\n<p>在测试集占 25% 的情况下，随机森林算法准确率最高，达到 77%，获得这个结果并不能让人满意。在特征数量不多，样本数据量不大的情况下，对算法调参带来的影响是比较小的。我认为，准确率不高的根本原因还是来源于数据本身，特征工程并不到位。相关性高的特征以我的水平暂时还没有整合出来，最终导致了这个结果。</p>\n<h1 id=\"4完整代码\"><a class=\"anchor\" href=\"#4完整代码\">#</a> 4. 完整代码</h1>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> train_test_split</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>preprocessing <span class=\"token keyword\">import</span> LabelEncoder<span class=\"token punctuation\">,</span> OneHotEncoder<span class=\"token punctuation\">,</span> MinMaxScaler</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>linear_model <span class=\"token keyword\">import</span> LogisticRegression</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>ensemble <span class=\"token keyword\">import</span> RandomForestClassifier</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>svm <span class=\"token keyword\">import</span> SVC</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>ensemble <span class=\"token keyword\">import</span> GradientBoostingClassifier</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>neighbors <span class=\"token keyword\">import</span> KNeighborsClassifier</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>naive_bayes <span class=\"token keyword\">import</span> GaussianNB</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>tree <span class=\"token keyword\">import</span> DecisionTreeClassifier</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>couponCsv <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"Coupon-Recommendation.csv\"</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 读取数据集</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'destination'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'No Urgent Place'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'destination'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'destination'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Home'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'destination'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'destination'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Work'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'destination'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span>  <span class=\"token comment\"># 处理 destination 特征</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'Bar'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'Bar'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>fillna<span class=\"token punctuation\">(</span><span class=\"token string\">'never'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'CoffeeHouse'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'CoffeeHouse'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>fillna<span class=\"token punctuation\">(</span><span class=\"token string\">'less1'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'CarryAway'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'CarryAway'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>fillna<span class=\"token punctuation\">(</span><span class=\"token string\">'1~3'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'RestaurantLessThan20'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'RestaurantLessThan20'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>fillna<span class=\"token punctuation\">(</span><span class=\"token string\">'1~3'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'Restaurant20To50'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'Restaurant20To50'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>fillna<span class=\"token punctuation\">(</span><span class=\"token string\">'less1'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 根据每种特征的数量最多的类型进行数据填充</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">cate</span><span class=\"token punctuation\">(</span>cate1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span>cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'never'</span><span class=\"token punctuation\">,</span> cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span>cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'less1'</span><span class=\"token punctuation\">,</span> cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span>cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'1~3'</span><span class=\"token punctuation\">,</span> cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span>cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'4~8'</span><span class=\"token punctuation\">,</span> cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span>cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'gt8'</span><span class=\"token punctuation\">,</span> cate1<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>cate<span class=\"token punctuation\">(</span><span class=\"token string\">'Bar'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>cate<span class=\"token punctuation\">(</span><span class=\"token string\">'CoffeeHouse'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>cate<span class=\"token punctuation\">(</span><span class=\"token string\">'CarryAway'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>cate<span class=\"token punctuation\">(</span><span class=\"token string\">'RestaurantLessThan20'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>cate<span class=\"token punctuation\">(</span><span class=\"token string\">'Restaurant20To50'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 特征数值化</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'expiration'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'1d'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'expiration'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'expiration'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'2h'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'expiration'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span>  <span class=\"token comment\"># expiration 特征处理</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'7AM'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'10AM'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'2PM'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'6PM'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'10PM'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'time'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">4</span>  <span class=\"token comment\"># time 特征处理</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'temperature'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'temperature'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'temperature'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">55</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'temperature'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'temperature'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'temperature'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span>  <span class=\"token comment\"># temperature 特征处理</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Less than $12500'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'$12500 - $24999'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'$25000 - $37499'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'$37500 - $49999'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'$50000 - $62499'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'$62500 - $74999'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'$75000 - $87499'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'$87500 - $99999'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'$100000 or More'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'income'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span>  <span class=\"token comment\"># income 特征处理</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'age'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'below21'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'age'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'age'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'21'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'age'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'age'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'26'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'age'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'age'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'31'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'age'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'age'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'36'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'age'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'age'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'41'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'age'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'age'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'46'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'age'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">6</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'age'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'50plus'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'age'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">7</span>  <span class=\"token comment\"># age 特征处理</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>le <span class=\"token operator\">=</span> LabelEncoder<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>ohc <span class=\"token operator\">=</span> OneHotEncoder<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre></pre></td></tr><tr><td data-num=\"75\"></td><td><pre></pre></td></tr><tr><td data-num=\"76\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">cate2</span><span class=\"token punctuation\">(</span>cate3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>    <span class=\"token keyword\">global</span> couponCsv</pre></td></tr><tr><td data-num=\"78\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> cate3<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> le<span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span>cate3<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>    alldf <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>get_dummies<span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span>cate3<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> prefix<span class=\"token operator\">=</span>cate3<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>    couponCsv <span class=\"token operator\">=</span> couponCsv<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>cate3<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>    couponCsv <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>concat<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">,</span> alldf<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre></pre></td></tr><tr><td data-num=\"83\"></td><td><pre></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>cate2<span class=\"token punctuation\">(</span><span class=\"token string\">'education'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>cate2<span class=\"token punctuation\">(</span><span class=\"token string\">'gender'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>cate2<span class=\"token punctuation\">(</span><span class=\"token string\">'passanger'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>cate2<span class=\"token punctuation\">(</span><span class=\"token string\">'weather'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>cate2<span class=\"token punctuation\">(</span><span class=\"token string\">'maritalStatus'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 独热编码处理特征</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Unemployed'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Architecture &amp; Engineering'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Student'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Education&amp;Training&amp;Library'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Healthcare Support'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Healthcare Practitioners &amp; Technical'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Sales &amp; Related'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Management'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Arts Design Entertainment Sports &amp; Media'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Computer &amp; Mathematical'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Life Physical Social Science'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Personal Care &amp; Service'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Community &amp; Social Services'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Office &amp; Administrative Support'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Construction &amp; Extraction'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Legal'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Retired'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Installation Maintenance &amp; Repair'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Transportation &amp; Material Moving'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Business &amp; Financial'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Protective Service'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Food Preparation &amp; Serving Related'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Production Occupations'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Building &amp; Grounds Cleaning &amp; Maintenance'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'Farming Fishing &amp; Forestry'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'occupation'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span>         <span class=\"token comment\"># occupation 特征处理</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>nan</pre></td></tr><tr><td data-num=\"117\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon_GEQ5min'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon_GEQ5min'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon_GEQ15min'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon_GEQ15min'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon_GEQ25min'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon_GEQ25min'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'toCoupon'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">3</span>  <span class=\"token comment\"># 整合三类特征形成新特征 toCoupon</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'accept'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>nan</pre></td></tr><tr><td data-num=\"123\"></td><td><pre></pre></td></tr><tr><td data-num=\"124\"></td><td><pre></pre></td></tr><tr><td data-num=\"125\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">cate4</span><span class=\"token punctuation\">(</span>cate6<span class=\"token punctuation\">,</span> cate5<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'coupon'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> cate6<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span>cate5<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'accept'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'coupon'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> cate6<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span>cate5<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'accept'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'coupon'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> cate6<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span>cate5<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'accept'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'coupon'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> cate6<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span>cate5<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'accept'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>    couponCsv<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'coupon'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> cate6<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>couponCsv<span class=\"token punctuation\">[</span>cate5<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'accept'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre></pre></td></tr><tr><td data-num=\"132\"></td><td><pre></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>cate4<span class=\"token punctuation\">(</span><span class=\"token string\">'Restaurant(&lt;20)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'RestaurantLessThan20'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>cate4<span class=\"token punctuation\">(</span><span class=\"token string\">'Coffee House'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'CoffeeHouse'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>cate4<span class=\"token punctuation\">(</span><span class=\"token string\">'Carry out &amp; Take away'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'CarryAway'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>cate4<span class=\"token punctuation\">(</span><span class=\"token string\">'Bar'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Bar'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>cate4<span class=\"token punctuation\">(</span><span class=\"token string\">'Restaurant(20-50)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Restaurant20To50'</span><span class=\"token punctuation\">)</span>           <span class=\"token comment\"># 创建新特征 accept</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre>cate2<span class=\"token punctuation\">(</span><span class=\"token string\">'coupon'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>source_X <span class=\"token operator\">=</span> couponCsv<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>    <span class=\"token punctuation\">[</span><span class=\"token string\">'direction_same'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'toCoupon_GEQ5min'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'toCoupon_GEQ15min'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'toCoupon_GEQ25min'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Y\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>source_y <span class=\"token operator\">=</span> couponCsv<span class=\"token punctuation\">[</span><span class=\"token string\">'Y'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>train_X<span class=\"token punctuation\">,</span> test_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">,</span> test_y <span class=\"token operator\">=</span> train_test_split<span class=\"token punctuation\">(</span>source_X<span class=\"token punctuation\">,</span> source_y<span class=\"token punctuation\">,</span> train_size<span class=\"token operator\">=</span><span class=\"token number\">0.75</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 划分测试集和训练集</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>sc <span class=\"token operator\">=</span> MinMaxScaler<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>train_X <span class=\"token operator\">=</span> sc<span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>test_X <span class=\"token operator\">=</span> sc<span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>test_X<span class=\"token punctuation\">)</span>     <span class=\"token comment\"># 数据标准化化处理</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre></pre></td></tr><tr><td data-num=\"149\"></td><td><pre><span class=\"token comment\"># 逻辑回归</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>model <span class=\"token operator\">=</span> LogisticRegression<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"逻辑回归:\"</span><span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">(</span>test_X<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre><span class=\"token comment\"># 随机森林</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre>model <span class=\"token operator\">=</span> RandomForestClassifier<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"随机森林:\"</span><span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">(</span>test_X<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre><span class=\"token comment\"># 支持向量机</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre>model <span class=\"token operator\">=</span> SVC<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre>model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"支持向量机:\"</span><span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">(</span>test_X<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre><span class=\"token comment\"># 梯度提升决策树</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre>model <span class=\"token operator\">=</span> GradientBoostingClassifier<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"163\"></td><td><pre>model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"梯度提升决策分类:\"</span><span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">(</span>test_X<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre><span class=\"token comment\"># KNN 算法</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre>model <span class=\"token operator\">=</span> KNeighborsClassifier<span class=\"token punctuation\">(</span>n_neighbors<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"KNN算法:\"</span><span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">(</span>test_X<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre><span class=\"token comment\"># 朴素贝叶斯分类</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre>model <span class=\"token operator\">=</span> GaussianNB<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"171\"></td><td><pre>model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"朴素贝叶斯分类:\"</span><span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">(</span>test_X<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre><span class=\"token comment\"># 决策树</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre>model <span class=\"token operator\">=</span> DecisionTreeClassifier<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre>model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"决策树:\"</span><span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">(</span>test_X<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre><span class=\"token comment\"># AdaBoostClassifier 算法</span></pre></td></tr><tr><td data-num=\"178\"></td><td><pre>model <span class=\"token operator\">=</span> DecisionTreeClassifier<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre>model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"180\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"AdaBoost算法:\"</span><span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">(</span>test_X<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure>",
            "tags": []
        }
    ]
}